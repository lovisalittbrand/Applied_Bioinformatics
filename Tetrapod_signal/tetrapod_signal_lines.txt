# alignment
for i in *.fa; do mafft --auto $i > ${i%.fasta}.mafft.fasta ; done


# Make all the sequence names the same

for i in *.mafft.fasta; do awk -F"_" '{if($0 ~ /^>/) print $1"_"$2"_"$3; else print $0}' $i > ${i%.fa.mafft.fasta}_aln.fasta; done


# Make concatenation and partition file
#Should be run with the -f flag to get a fasta file as output instead of a phylip file

perl catfasta2phyml.pl -c *_aln.fasta > tetrapod.fasta 2> tetra.part


# Run iq-tree to find the best tree according to the algoritm

iqtree -s tetrapod.fasta -st "AA" -wsl -nt 1 -pre T1_ML


# Run iq-tree on a modified tree file with the different topology compared to the one achieved in the previous run

iqtree -wsl -nt 2 -st "AA" -s tetrapod.fasta -m JTT+R3 -g T2.treefile -pre T2_ML